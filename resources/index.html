<!DOCTYPE html>
<html>
<head>
    <script type="text/javascript">
        window.addEventListener("load", async function () {
            var res = await fetch("/store/apple");
            var get = document.getElementById("get");
            get.textContent = await res.text();

            var mySocket = new WebSocket("ws://127.0.0.1:3000/ws");
            mySocket.onmessage = async function (event) {
                var output = document.getElementById("output");
                const newDiv = document.createElement("div");
                newDiv.textContent = event.data;
                output.appendChild(newDiv);

                var res = await fetch("/get");
                var get = document.getElementById("get");
                get.textContent = await res.text();

                var res = await fetch("/vclock");
                var vclock = document.getElementById("vclock");
                vclock.textContent = await res.text();
            };

            var replace = document.forms["replace"]
            replace.addEventListener("submit", async function (e) {
                e.preventDefault();

                var key = replace["key"].value;
                var value = replace["value"].value;

                var res = fetch("/store/" + key, {
                    method: "POST",
                    body: value
                });
            })
        });
    </script>
    <style>
    </style>
</head>
<body>
<h2>/replace</h2>
<form name="replace" style="display: flex; flex-direction: column; gap: 10px; width: 200px">
    <div style="display: flex; flex-direction: row; gap: 10px">
        <div style="width: 50px;">Key:</div>
        <input name="key" value="apple">
    </div>
    <div style="display: flex; flex-direction: row; gap: 10px">
        <div style="width: 50px;">Value:</div>
        <input name="value">
    </div>
    <input type="submit" value="Submit"></input>
</form>
<h2>/get</h2>
<div id="get"></div>
<h2>/vclock</h2>
<div id="vclock"></div>
<h2>/ws</h2>
<div id="output"></div>
</body>
</html>